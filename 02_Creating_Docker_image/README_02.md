# Dockerfile - Основи та Практика

## Зміст уроку

1. **Dockerfile - для чого він, і що містить**
2. **Основні команди Dockerfile**
3. **Збираємо простий образ Docker**
4. **Multi stage Dockerfile**
5. **Публікація образу у Docker Hub у форматі та файлі README.md**

## 1. Dockerfile - для чого він, і що містить
Dockerfile — це текстовий файл, що містить інструкції для побудови Docker-образу. Він описує кроки для налаштування середовища, встановлення необхідних залежностей і копіювання файлів в контейнер. Dockerfile дозволяє автоматизувати процес створення образів, що зручно для деплою додатків.

### Основні елементи Dockerfile:
- **FROM**: вказує базовий образ, від якого будується новий образ.
- **RUN**: виконує команду або скрипт всередині контейнера.
- **COPY**: копіює файли з хост-машини в контейнер.
- **ADD**: схоже на COPY, але має додаткові можливості (наприклад, розпаковування архівів).
- **CMD**: вказує команду, яка буде виконана при запуску контейнера.
- **EXPOSE**: вказує порти, які контейнер буде прослуховувати.
- **ENV**: задає змінні середовища.

## 2. Основні команди Dockerfile
- **FROM <image>**: вказує базовий образ для створення нового образу.
- **RUN <command>**: виконує команду під час побудови образу.
- **COPY <src> <dest>**: копіює файли або каталоги з хоста до контейнера.
- **ADD <src> <dest>**: подібно до COPY, але з додатковими можливостями (наприклад, автоматично розпаковує архіви).
- **CMD ["executable", "param1", "param2"]**: вказує команду, яку контейнер буде виконувати під час запуску.
- **ENTRYPOINT ["executable", "param1"]**: встановлює точку входу для контейнера.
- **EXPOSE <port>**: вказує, який порт буде відкритий для спілкування з іншими контейнерами чи хост-системою.
- **ENV <key>=<value>**: задає змінну середовища.
- **VOLUME <path>**: вказує на каталог, який буде монтуватися як том.
- **WORKDIR <path>**: встановлює робочу директорію для наступних команд.

## 3. Збираємо простий образ Docker
Для створення простого Docker-образу потрібно виконати кілька кроків:
1. Створити Dockerfile.
2. Використовувати команду `docker build` для побудови образу:
   ```bash
   docker build -t my-image .
Це створить образ на основі Dockerfile в поточній директорії.

## Приклад простого Dockerfile:

``` bash
FROM ubuntu:20.04
RUN apt-get update && apt-get install -y python3
COPY app.py /app.py
CMD ["python3", "/app.py"] 
```

Цей Dockerfile створює образ на основі Ubuntu, встановлює Python 3, копіює файл app.py та запускає його при старті контейнера.

## 4. Multi stage Dockerfile
Multi-stage Dockerfile дозволяє зменшити розмір кінцевого образу, створюючи декілька етапів збірки. На першому етапі встановлюються всі інструменти для компіляції чи налаштування, а на наступному етапі копіюється лише необхідний результат, без зайвих залежностей.

### Приклад:
```bash
Dockerfile
# Stage 1: будування
FROM node:14 AS build
WORKDIR /app
COPY . .
RUN npm install && npm run build

# Stage 2: виконання
FROM nginx:alpine
COPY --from=build /app/build /usr/share/nginx/html

У цьому прикладі перший етап будує додаток на Node.js, а другий етап створює мінімальний образ з лише необхідними файлами для запуску через Nginx.
```

## 5. Публікація образу у Docker Hub

Щоб публікувати Docker-образ в Docker Hub, потрібно:

1. Створити обліковий запис на Docker Hub.
2. Виконати вхід через командний рядок:

```bash
docker login
```
3. Тегувати образ:

```bash
docker tag my-image username/my-image:latest
```
4. Публікувати образ:

```bash
docker push username/my-image:latest
```


